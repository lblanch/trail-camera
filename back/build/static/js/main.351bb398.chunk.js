(this.webpackJsonptrailcam=this.webpackJsonptrailcam||[]).push([[0],{141:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(97),s=n.n(c),o=n(178),i=n(10),u=n.n(i),j=n(18),l=n(4),d=n(15),b=n(100),p=n(180),x=n(51),h=n(160),O=n(181),f=n(161),g=n(162),v=n(176),m=n(3),w=function(e){var t=e.loginUser,n=Object(r.useState)(!1),a=Object(l.a)(n,2),c=a[0],s=a[1],o=function(){var e=Object(j.a)(u.a.mark((function e(n){var r,a,c,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),r=n.target.elements,a=r.email,c=r.password,s={email:a.value,password:c.value},a.value="",c.value="",e.next=7,t(s);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(m.jsx)(p.c,{children:Object(m.jsxs)("form",{name:"login-form",onSubmit:o,children:[Object(m.jsxs)(x.a,{id:"email",children:[Object(m.jsx)(h.a,{children:"Email"}),Object(m.jsx)(O.a,{variant:"outline",name:"email",type:"text",placeholder:"Email"})]}),Object(m.jsxs)(x.a,{id:"password",children:[Object(m.jsx)(h.a,{children:"Password"}),Object(m.jsxs)(f.a,{children:[Object(m.jsx)(O.a,{variant:"outline",name:"password",type:c?"text":"password",placeholder:"Password"}),Object(m.jsx)(g.a,{children:Object(m.jsx)(v.a,{onClick:function(){s(!c)},children:c?"Hide":"Show"})})]})]}),Object(m.jsx)(v.a,{variant:"solid",name:"login-button",type:"submit",children:"Login"})]})})},y=n(2),k=n(163),S=n(164),I=n(165),C=n(175),R=n(177),L=n(166),D=n(106),_=n(167),E=n(168),P=n(169),U=a.a.forwardRef((function(e,t){return Object(m.jsxs)(p.a,{as:"button",name:e.name,onClick:e.onClick,ref:t,children:[Object(m.jsx)(k.a,{name:e.children.props.children,size:"sm",src:""}),Object(m.jsx)(S.a,{children:e.children.props.children})]})})),z=function(e){var t=e.user,n=e.logout,r=function(){var e=Object(j.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(m.jsx)(I.a,{alignItems:"center",justifyContent:"space-between",children:Object(m.jsxs)(C.a,{children:[Object(m.jsx)(C.b,{name:"user-avatar",as:U,rounded:"full",variant:"link",cursor:"pointer",minW:0,children:t.name}),Object(m.jsxs)(C.e,{name:"user-menu",children:["admin"===t.role?Object(m.jsx)(C.d,{children:"Settings"}):Object(m.jsx)(m.Fragment,{}),Object(m.jsx)(C.d,{children:"Profile"}),Object(m.jsx)(C.c,{}),Object(m.jsx)(C.d,{name:"user-logout",onClick:r,children:"Logout"})]})]})})},B=function(e){var t,n=e.loading,r=e.user,a=e.logout,c=Object(m.jsx)(R.a,{height:"20px"}),s=Object(m.jsx)(L.a,{sx:(t={position:"-webkit-sticky"},Object(y.a)(t,"position","sticky"),Object(y.a)(t,"top",0),Object(y.a)(t,"z-index",1),t),name:"app-header",bg:Object(D.c)("gray.100","gray.900"),px:4,children:Object(m.jsxs)(I.a,{h:16,alignItems:"center",justifyContent:"space-between",children:[Object(m.jsx)(_.a,{children:Object(m.jsx)(E.a,{_hover:{textDecoration:"none"},href:"#top",children:"TrailCam"})}),Object(m.jsx)(P.a,{}),null!==r?Object(m.jsx)(z,{user:r,logout:a}):Object(m.jsx)(m.Fragment,{})]})});return n?c:s},F=n(16),T=n(170),W=n(171),J=n(172),H=n(173),M=n(174),N=n(182),q=n(44),A=n(42),G=n.n(A),K="/api/recordings",Q=function(){var e=Object(j.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.a.get(K);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),V=function(){var e=Object(j.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.a.get("".concat(K,"/").concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),X={getRecordingsByPage:V,getInitialRecordings:Q},Y=function(e){var t=e.dayIndex,n=e.index,r=e.recording;return Object(m.jsx)(T.a,{name:"recording-".concat(t,"-").concat(n),children:Object(m.jsxs)(L.a,{maxW:"445px",w:"full",bg:Object(D.c)("white","gray.900"),boxShadow:"2xl",rounded:"md",p:4,overflow:"hidden",children:[Object(m.jsx)(L.a,{bg:"gray.100",mt:-6,mx:-6,mb:6,pos:"relative",children:Object(m.jsx)(W.a,{name:"thumbnail-".concat(t,"-").concat(n),src:r.mediaThumbnailURL,layout:"fill"})}),Object(m.jsxs)(p.b,{children:[Object(m.jsx)(_.a,{color:Object(D.c)("gray.700","white"),fontSize:"2xl",fontFamily:"body",children:new Date(r.mediaDate).toLocaleTimeString()}),Object(m.jsx)(J.a,{name:"info-".concat(t,"-").concat(n),spacing:3,children:Object.entries(r.emailBody).map((function(e){var t=Object(l.a)(e,2),n=t[0],r=t[1],a=q.b;return"temperature"===n?a=q.e:"date"===n?a=q.a:"time"===n&&(a=q.c),Object(m.jsxs)(J.c,{children:[Object(m.jsx)(J.b,{as:a,color:"green.500"}),Object(m.jsxs)("b",{children:[n,":"]})," ",r]},n)}))})]}),Object(m.jsx)(H.a,{spacing:"10px",justify:"left",py:4,children:r.tags.map((function(e){return Object(m.jsx)(H.b,{children:Object(m.jsxs)(M.a,{variant:"subtle",colorScheme:e.color,children:[Object(m.jsx)(M.d,{boxSize:"12px",as:q.d}),Object(m.jsx)(M.c,{children:e.tag}),Object(m.jsx)(M.b,{})]})},e._id)}))})]})})},Z=function(e){var t=e.dayIndex,n=e.dayRecordings;return Object(m.jsxs)(L.a,{name:"recordings-".concat(t),p:4,children:[Object(m.jsx)(_.a,{children:new Date(n.date).toLocaleDateString()}),Object(m.jsx)(N.a,{minChildWidth:"300px",spacing:"40px",py:4,children:n.recordings.map((function(e,n){return Object(m.jsx)(Y,{dayIndex:t,index:n,recording:e},e._id)}))})]})},$=function(){var e=Object(r.useState)([]),t=Object(l.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(!1),s=Object(l.a)(c,2),o=s[0],i=s[1],d=Object(r.useState)(1),b=Object(l.a)(d,2),p=b[0],x=b[1],h=Object(r.useState)(!0),O=Object(l.a)(h,2),f=O[0],g=O[1],v=Object(r.useRef)(),w=Object(r.useCallback)((function(e){o||(v.current&&v.current.disconnect(),v.current=new IntersectionObserver((function(e){e[0].isIntersecting&&!f&&x((function(e){return e+1}))})),e&&v.current.observe(e))}),[o,f]);return Object(r.useEffect)((function(){var e=function(){var e=Object(j.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,X.getRecordingsByPage(p);case 3:0!==(t=e.sent).count?(a((function(e){var n=e.length;if(0===n)return[t];if(e[n-1].date===t.date){var r={_id:e[n-1]._id,count:e[n-1].count+t.count,date:t.date,recordings:e[n-1].recordings.concat(t.recordings)};return[].concat(Object(F.a)(e.slice(0,-1)),[r])}return[].concat(Object(F.a)(e),[t])})),g(!1)):g(!0),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),e.t0.response?e.t0.response.data.error?console.log(e.t0.response.data.error):console.log(e.t0.response.data):console.log(e.t0);case 10:return e.prev=10,i(!1),e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[0,7,10,13]])})));return function(){return e.apply(this,arguments)}}();i(!0),e()}),[p]),Object(m.jsxs)(m.Fragment,{children:[n.map((function(e,t){return Object(m.jsx)(Z,{dayIndex:t,dayRecordings:e},e._id)})),Object(m.jsx)(R.a,{isLoaded:!o,height:"20px",children:Object(m.jsx)("div",{ref:w,children:1===p&&!0===f&&"No results"})})]})},ee=function(e){var t=e.message;return null===t||0===t.length?null:Object(m.jsx)("div",{name:"notification",children:t})},te="/api/auth",ne=function(){var e=Object(j.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.a.post("".concat(te,"/login"),t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),re=function(){var e=Object(j.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.a.post("".concat(te,"/logout"));case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ae=function(){var e=Object(j.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.a.get(te);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ce={login:ne,logout:re,auth:ae},se=function(e){var t=e.user,n=e.loginUser;return Object(m.jsxs)(d.d,{children:[Object(m.jsx)(d.b,{path:"/login",children:null===t?Object(m.jsx)(w,{loginUser:n}):Object(m.jsx)(d.a,{to:"/dashboard"})}),Object(m.jsx)(d.b,{path:"/dashboard",children:null===t?Object(m.jsx)(d.a,{to:"/login"}):Object(m.jsx)($,{})}),Object(m.jsx)(d.b,{children:null===t?Object(m.jsx)(d.a,{to:"/login"}):Object(m.jsx)(d.a,{to:"/dashboard"})})]})},oe=function(){var e=Object(r.useState)(null),t=Object(l.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(!0),s=Object(l.a)(c,2),o=s[0],i=s[1],d=Object(r.useState)(""),p=Object(l.a)(d,2),x=p[0],h=p[1];Object(r.useEffect)((function(){var e=function(){var e=Object(j.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ce.auth();case 3:t=e.sent,a(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),e.t0.response?e.t0.response.data.error?console.log(e.t0.response.data.error):console.log(e.t0.response.data):console.log(e.t0);case 10:return e.prev=10,i(!1),e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[0,7,10,13]])})));return function(){return e.apply(this,arguments)}}();e()}),[]);var O=function(){var e=Object(j.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(!0),e.prev=1,e.next=4,ce.login(t);case 4:n=e.sent,a(n),h(""),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),e.t0.response.data.error?h(e.t0.response.data.error):h(e.t0.response.data);case 12:return e.prev=12,i(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,9,12,15]])})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=Object(j.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ce.logout();case 3:a(null),h("Logout successful"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),e.t0.response.data.error?h(e.t0.response.data.error):h(e.t0.response.data);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(m.jsxs)(b.a,{children:[Object(m.jsx)(B,{loading:o,user:n,logout:f}),Object(m.jsx)(ee,{message:x}),o?Object(m.jsx)(R.a,{height:"50px"}):Object(m.jsx)(se,{user:n,loginUser:O})]})};s.a.render(Object(m.jsx)(o.a,{children:Object(m.jsx)(a.a.StrictMode,{children:Object(m.jsx)(oe,{})})}),document.getElementById("root"))}},[[141,1,2]]]);
//# sourceMappingURL=main.351bb398.chunk.js.map