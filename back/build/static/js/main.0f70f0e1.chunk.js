(this.webpackJsonptrailcam=this.webpackJsonptrailcam||[]).push([[0],{141:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(97),s=n.n(c),o=n(177),i=n(10),u=n.n(i),j=n(18),l=n(4),d=n(14),b=n(100),p=n(179),x=n(51),O=n(160),h=n(180),f=n(161),g=n(162),m=n(175),v=n(3),w=function(e){var t=e.loginUser,n=Object(r.useState)(!1),a=Object(l.a)(n,2),c=a[0],s=a[1],o=function(){var e=Object(j.a)(u.a.mark((function e(n){var r,a,c,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),r=n.target.elements,a=r.email,c=r.password,s={email:a.value,password:c.value},a.value="",c.value="",e.next=7,t(s);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(v.jsx)(p.b,{children:Object(v.jsxs)("form",{name:"login-form",onSubmit:o,children:[Object(v.jsxs)(x.a,{id:"email",children:[Object(v.jsx)(O.a,{children:"Email"}),Object(v.jsx)(h.a,{variant:"outline",name:"email",type:"text",placeholder:"Email"})]}),Object(v.jsxs)(x.a,{id:"password",children:[Object(v.jsx)(O.a,{children:"Password"}),Object(v.jsxs)(f.a,{children:[Object(v.jsx)(h.a,{variant:"outline",name:"password",type:c?"text":"password",placeholder:"Password"}),Object(v.jsx)(g.a,{children:Object(v.jsx)(m.a,{onClick:function(){s(!c)},children:c?"Hide":"Show"})})]})]}),Object(v.jsx)(m.a,{variant:"solid",name:"login-button",type:"submit",children:"Login"})]})})},y=n(163),k=n(174),S=n(164),I=n(165),L=n(166),C=n(176),R=n(106),D=n(167),E=n(168),P=function(e){var t=e.user,n=e.logout,r=function(){var e=Object(j.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(v.jsxs)(y.a,{alignItems:"center",justifyContent:"space-between",children:[Object(v.jsxs)(k.a,{children:[Object(v.jsx)(k.b,{name:"user-avatar",as:m.a,rounded:"full",variant:"link",cursor:"pointer",minW:0,children:Object(v.jsx)(S.a,{name:t.name,size:"sm",src:""})}),Object(v.jsxs)(k.e,{name:"user-menu",children:["admin"===t.role?Object(v.jsx)(k.d,{children:"Settings"}):Object(v.jsx)(v.Fragment,{}),Object(v.jsx)(k.d,{children:"Profile"}),Object(v.jsx)(k.c,{}),Object(v.jsx)(k.d,{name:"user-logout",onClick:r,children:"Logout"})]})]}),Object(v.jsx)(I.a,{p:3,children:Object(v.jsx)(L.a,{children:t.name})})]})},U=function(e){var t=e.loading,n=e.user,r=e.logout;return Object(v.jsx)(C.a,{isLoaded:!t,children:Object(v.jsx)(I.a,{name:"app-header",bg:Object(R.c)("gray.100","gray.900"),px:4,children:Object(v.jsxs)(y.a,{h:16,alignItems:"center",justifyContent:"space-between",children:[Object(v.jsx)(D.a,{children:"TrailCam"}),Object(v.jsx)(E.a,{}),null!==n?Object(v.jsx)(P,{user:n,logout:r}):Object(v.jsx)(v.Fragment,{})]})})})},_=n(16),B=n(169),F=n(170),z=n(171),T=n(172),W=n(173),J=n(181),H=n(44),M=n(42),N=n.n(M),q="/api/recordings",A=function(){var e=Object(j.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.a.get(q);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),G={getRecordingsByPage:function(){var e=Object(j.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.a.get("".concat(q,"/").concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getInitialRecordings:A},K=function(e){var t=e.dayIndex,n=e.index,r=e.recording;return Object(v.jsx)(B.a,{name:"recording-".concat(t,"-").concat(n),children:Object(v.jsxs)(I.a,{maxW:"445px",w:"full",bg:Object(R.c)("white","gray.900"),boxShadow:"2xl",rounded:"md",p:4,overflow:"hidden",children:[Object(v.jsx)(I.a,{bg:"gray.100",mt:-6,mx:-6,mb:6,pos:"relative",children:Object(v.jsx)(F.a,{name:"thumbnail-".concat(t,"-").concat(n),src:r.mediaThumbnailURL,layout:"fill"})}),Object(v.jsxs)(p.a,{children:[Object(v.jsx)(D.a,{color:Object(R.c)("gray.700","white"),fontSize:"2xl",fontFamily:"body",children:new Date(r.mediaDate).toLocaleTimeString()}),Object(v.jsx)(z.a,{name:"info-".concat(t,"-").concat(n),spacing:3,children:Object.entries(r.emailBody).map((function(e){var t=Object(l.a)(e,2),n=t[0],r=t[1],a=H.b;return"temperature"===n?a=H.e:"date"===n?a=H.a:"time"===n&&(a=H.c),Object(v.jsxs)(z.c,{children:[Object(v.jsx)(z.b,{as:a,color:"green.500"}),Object(v.jsxs)("b",{children:[n,":"]})," ",r]},n)}))})]}),Object(v.jsx)(T.a,{spacing:"10px",justify:"left",py:4,children:r.tags.map((function(e){return Object(v.jsx)(T.b,{children:Object(v.jsxs)(W.a,{variant:"subtle",colorScheme:e.color,children:[Object(v.jsx)(W.d,{boxSize:"12px",as:H.d}),Object(v.jsx)(W.c,{children:e.tag}),Object(v.jsx)(W.b,{})]})},e._id)}))})]})})},Q=function(e){var t=e.dayIndex,n=e.dayRecordings;return Object(v.jsxs)(I.a,{name:"recordings-".concat(t),p:4,children:[Object(v.jsx)(D.a,{children:new Date(n.date).toLocaleDateString()}),Object(v.jsx)(J.a,{minChildWidth:"300px",spacing:"40px",py:4,children:n.recordings.map((function(e,n){return Object(v.jsx)(K,{dayIndex:t,index:n,recording:e},e._id)}))})]})},V=function(){var e=Object(r.useState)([]),t=Object(l.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(!1),s=Object(l.a)(c,2),o=s[0],i=s[1],d=Object(r.useState)(1),b=Object(l.a)(d,2),p=b[0],x=b[1],O=Object(r.useState)(!0),h=Object(l.a)(O,2),f=h[0],g=h[1],m=Object(r.useRef)(),w=Object(r.useCallback)((function(e){o||(m.current&&m.current.disconnect(),m.current=new IntersectionObserver((function(e){e[0].isIntersecting&&!f&&x((function(e){return e+1}))})),e&&m.current.observe(e))}),[o,f]);return Object(r.useEffect)((function(){var e=function(){var e=Object(j.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,G.getRecordingsByPage(p);case 3:0!==(t=e.sent).count?(a((function(e){var n=e.length;if(0===n)return[t];if(e[n-1].date===t.date){var r={_id:e[n-1]._id,count:e[n-1].count+t.count,date:t.date,recordings:e[n-1].recordings.concat(t.recordings)};return[].concat(Object(_.a)(e.slice(0,-1)),[r])}return[].concat(Object(_.a)(e),[t])})),g(!1)):g(!0),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),e.t0.response?e.t0.response.data.error?console.log(e.t0.response.data.error):console.log(e.t0.response.data):console.log(e.t0);case 10:return e.prev=10,i(!1),e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[0,7,10,13]])})));return function(){return e.apply(this,arguments)}}();i(!0),e()}),[p]),Object(v.jsxs)(v.Fragment,{children:[n.map((function(e,t){return Object(v.jsx)(Q,{dayIndex:t,dayRecordings:e},e._id)})),Object(v.jsx)(C.a,{isLoaded:!o,height:"20px",children:Object(v.jsx)("div",{ref:w,children:1===p&&!0===f&&"No results"})})]})},X=function(e){var t=e.message;return null===t||0===t.length?null:Object(v.jsx)("div",{name:"notification",children:t})},Y="/api/auth",Z={login:function(){var e=Object(j.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.a.post("".concat(Y,"/login"),t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),logout:function(){var e=Object(j.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.a.post("".concat(Y,"/logout"));case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),auth:function(){var e=Object(j.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.a.get(Y);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},$=function(e){var t=e.user,n=e.loginUser;return Object(v.jsxs)(d.d,{children:[Object(v.jsx)(d.b,{path:"/login",children:null===t?Object(v.jsx)(w,{loginUser:n}):Object(v.jsx)(d.a,{to:"/dashboard"})}),Object(v.jsx)(d.b,{path:"/dashboard",children:null===t?Object(v.jsx)(d.a,{to:"/login"}):Object(v.jsx)(V,{})}),Object(v.jsx)(d.b,{children:null===t?Object(v.jsx)(d.a,{to:"/login"}):Object(v.jsx)(d.a,{to:"/dashboard"})})]})},ee=function(){var e=Object(r.useState)(null),t=Object(l.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(!0),s=Object(l.a)(c,2),o=s[0],i=s[1],d=Object(r.useState)(""),p=Object(l.a)(d,2),x=p[0],O=p[1];Object(r.useEffect)((function(){(function(){var e=Object(j.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Z.auth();case 3:t=e.sent,a(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),e.t0.response?e.t0.response.data.error?console.log(e.t0.response.data.error):console.log(e.t0.response.data):console.log(e.t0);case 10:return e.prev=10,i(!1),e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[0,7,10,13]])})));return function(){return e.apply(this,arguments)}})()()}),[]);var h=function(){var e=Object(j.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(!0),e.prev=1,e.next=4,Z.login(t);case 4:n=e.sent,a(n),O(""),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),e.t0.response.data.error?O(e.t0.response.data.error):O(e.t0.response.data);case 12:return e.prev=12,i(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,9,12,15]])})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=Object(j.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Z.logout();case 3:a(null),O("Logout successful"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),e.t0.response.data.error?O(e.t0.response.data.error):O(e.t0.response.data);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(v.jsxs)(b.a,{children:[Object(v.jsx)(U,{loading:o,user:n,logout:f}),Object(v.jsx)(X,{message:x}),o?Object(v.jsx)(C.a,{height:"50px"}):Object(v.jsx)($,{user:n,loginUser:h})]})};s.a.render(Object(v.jsx)(o.a,{children:Object(v.jsx)(a.a.StrictMode,{children:Object(v.jsx)(ee,{})})}),document.getElementById("root"))}},[[141,1,2]]]);
//# sourceMappingURL=main.0f70f0e1.chunk.js.map